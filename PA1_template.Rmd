<p>First we need to download the data: </p>


<p>Then we need to read the data</p>

<div class="highlight highlight-source-r"><pre><span class="pl-v">dat</span> <span class="pl-k">=</span> read.csv(<span class="pl-s"><span class="pl-pds">'</span>activity.csv<span class="pl-pds">'</span></span>, <span class="pl-v">header</span> <span class="pl-k">=</span> <span class="pl-c1">T</span>)
names(<span class="pl-smi">dat</span>)
str(<span class="pl-smi">dat</span>)
head(<span class="pl-smi">dat</span>)</pre></div>

<h3><a id="user-content-Histogram, Mean and Median" class="anchor" href="#Histogram, Mean and Median" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Histogram, Mean &amp; Median</h3>

<hr>


<div class="highlight highlight-source-r"><pre><span class="pl-c">#Making The Generation of This Plot Into A Function So I Can Re-use Later</span>
<span class="pl-v">gen_hist</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">x</span>, <span class="pl-smi">title</span>){
        hist(<span class="pl-smi">x</span>, 
             <span class="pl-v">breaks</span> <span class="pl-k">=</span> <span class="pl-c1">20</span>,
             <span class="pl-v">main</span> <span class="pl-k">=</span> <span class="pl-smi">title</span>,
             <span class="pl-v">xlab</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Total Number of Steps<span class="pl-pds">'</span></span>, <span class="pl-v">col</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>grey<span class="pl-pds">'</span></span>,

             <span class="pl-v">cex.main</span> <span class="pl-k">=</span> .<span class="pl-c1">9</span>)

        <span class="pl-c">#caluclate mean and median</span>
        <span class="pl-v">mean_value</span> <span class="pl-k">=</span> round(mean(<span class="pl-smi">x</span>), <span class="pl-c1">1</span>)
        <span class="pl-v">median_value</span> <span class="pl-k">=</span> round(median(<span class="pl-smi">x</span>), <span class="pl-c1">1</span>)

        <span class="pl-c">#place lines for mean and median on histogram</span>
        abline(<span class="pl-v">v</span><span class="pl-k">=</span><span class="pl-smi">mean_value</span>, <span class="pl-v">lwd</span> <span class="pl-k">=</span> <span class="pl-c1">3</span>, <span class="pl-v">col</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>blue<span class="pl-pds">'</span></span>)
        abline(<span class="pl-v">v</span><span class="pl-k">=</span><span class="pl-smi">median_value</span>, <span class="pl-v">lwd</span> <span class="pl-k">=</span> <span class="pl-c1">3</span>, <span class="pl-v">col</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>red<span class="pl-pds">'</span></span>)

        <span class="pl-c">#create legend</span>
        legend(<span class="pl-s"><span class="pl-pds">'</span>topright<span class="pl-pds">'</span></span>, <span class="pl-v">lty</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>, <span class="pl-v">lwd</span> <span class="pl-k">=</span> <span class="pl-c1">3</span>, <span class="pl-v">col</span> <span class="pl-k">=</span> c(<span class="pl-s"><span class="pl-pds">"</span>blue<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>red<span class="pl-pds">"</span></span>),
               <span class="pl-v">cex</span> <span class="pl-k">=</span> .<span class="pl-c1">8</span>, 
               <span class="pl-v">legend</span> <span class="pl-k">=</span> c(paste(<span class="pl-s"><span class="pl-pds">'</span>Mean: <span class="pl-pds">'</span></span>, <span class="pl-smi">mean_value</span>),
               paste(<span class="pl-s"><span class="pl-pds">'</span>Median: <span class="pl-pds">'</span></span>, <span class="pl-smi">median_value</span>))
               )
}

gen_hist(<span class="pl-smi">dat_tbl_summary</span><span class="pl-k">$</span><span class="pl-smi">total_steps</span>, <span class="pl-s"><span class="pl-pds">'</span>Number of Steps Taken Per Day<span class="pl-pds">'</span></span>)</pre></div>

<h3><a id="user-content-daily-activity-pattern" class="anchor" href="#daily-activity-pattern" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Daily Activity Pattern</h3>

<hr>

<div class="highlight highlight-source-r"><pre><span class="pl-c">#summarize dataset by interval</span>
<span class="pl-v">dat_tbl_summary_intv</span> <span class="pl-k">=</span> <span class="pl-smi">dat_tbl</span>[, <span class="pl-k">list</span>(<span class="pl-v">avg_steps</span> <span class="pl-k">=</span> mean(<span class="pl-smi">steps</span>, <span class="pl-v">na.rm</span> <span class="pl-k">=</span> <span class="pl-c1">T</span>)), 
                          <span class="pl-v">by</span> <span class="pl-k">=</span> <span class="pl-smi">interval</span>]
<span class="pl-c">#plot the time series</span>
with(<span class="pl-smi">dat_tbl_summary_intv</span>, {
        plot(<span class="pl-smi">interval</span>, <span class="pl-smi">avg_steps</span>, <span class="pl-v">type</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>l<span class="pl-pds">'</span></span>,
             <span class="pl-v">main</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Average Steps by Time Interval<span class="pl-pds">'</span></span>,
             <span class="pl-v">xlab</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>5 Minute Time Interval<span class="pl-pds">'</span></span>,
             <span class="pl-v">ylab</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Average Number of Steps<span class="pl-pds">'</span></span>)
        })
<span class="pl-c">#Find Interval That Has The Maximum Avg Steps</span>
<span class="pl-v">max_steps</span> <span class="pl-k">=</span> <span class="pl-smi">dat_tbl_summary_intv</span>[which.max(<span class="pl-smi">avg_steps</span>), ]

<span class="pl-c">#Generate Label String</span>
<span class="pl-v">max_lab</span> <span class="pl-k">=</span> paste(<span class="pl-s"><span class="pl-pds">'</span>Maximum Of <span class="pl-pds">'</span></span>, round(<span class="pl-smi">max_steps</span><span class="pl-k">$</span><span class="pl-smi">avg_steps</span>, <span class="pl-c1">1</span>), <span class="pl-s"><span class="pl-pds">'</span> Steps <span class="pl-cce">\n</span> On <span class="pl-pds">'</span></span>, <span class="pl-smi">max_steps</span><span class="pl-k">$</span><span class="pl-smi">interval</span>, <span class="pl-s"><span class="pl-pds">'</span>th Time Interval<span class="pl-pds">'</span></span>, <span class="pl-v">sep</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>)

<span class="pl-c">#Collect Cooridinates of The Max Interval For Graphing</span>
points(<span class="pl-smi">max_steps</span><span class="pl-k">$</span><span class="pl-smi">interval</span>,  <span class="pl-smi">max_steps</span><span class="pl-k">$</span><span class="pl-smi">avg_steps</span>, <span class="pl-v">col</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>red<span class="pl-pds">'</span></span>, <span class="pl-v">lwd</span> <span class="pl-k">=</span> <span class="pl-c1">3</span>, <span class="pl-v">pch</span> <span class="pl-k">=</span> <span class="pl-c1">19</span>)

<span class="pl-c">#Add Label To Annotate Maximum # Steps And Interval</span>
legend(<span class="pl-s"><span class="pl-pds">"</span>topright<span class="pl-pds">"</span></span>,
       <span class="pl-v">legend</span> <span class="pl-k">=</span> <span class="pl-smi">max_lab</span>,
       <span class="pl-v">text.col</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>red<span class="pl-pds">'</span></span>,
       <span class="pl-v">bty</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>n<span class="pl-pds">'</span></span>
       )
</pre></div>

<hr>

<h3><a id="user-content-missing-values" class="anchor" href="#missing-values" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Missing Values</h3>

<ol>
<li>Calculate &amp; Report The Number of Missing Values</li>
</ol>

<div class="highlight highlight-source-r"><pre>sum(is.na(<span class="pl-smi">dat</span><span class="pl-k">$</span><span class="pl-smi">steps</span>))</pre></div>

<ol>
<li><p>Devise a strategy for filling in all of the missing values in the dataset. The strategy does not need to be sophisticated. For example, you could use the mean/median for that day, or the mean for that 5-minute interval, etc.</p></li>
<li><p>Create a new dataset that is equal to the original dataset but with the missing data filled in.</p></li>
</ol>

<div class="highlight highlight-source-r"><pre><span class="pl-c">#First I will join the dataframe I created earlier that summarizes the average number of steps per interval to the original dataset</span>
setkey(<span class="pl-smi">dat_tbl</span>, <span class="pl-smi">interval</span>)
setkey(<span class="pl-smi">dat_tbl_summary_intv</span>, <span class="pl-smi">interval</span>)


<span class="pl-c">#Create function that will return the second value if the first value is NA</span>
<span class="pl-v">NA_replace</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">x</span>,<span class="pl-smi">y</span>){
        <span class="pl-k">if</span>(is.na(<span class="pl-smi">x</span>)){

                <span class="pl-k">return</span>(<span class="pl-smi">y</span>)
        }
        <span class="pl-k">return</span>(<span class="pl-smi">x</span>)
}

<span class="pl-c">#create new dataset that replaces NAs with average values</span>
<span class="pl-v">dat_tbl_miss</span> <span class="pl-k">=</span> <span class="pl-smi">dat_tbl</span>[<span class="pl-smi">dat_tbl_summary_intv</span>]
<span class="pl-smi">dat_tbl_miss</span><span class="pl-k">$</span><span class="pl-v">new_steps</span> <span class="pl-k">=</span> mapply(<span class="pl-smi">NA_replace</span>,<span class="pl-smi">dat_tbl_miss</span><span class="pl-k">$</span><span class="pl-smi">steps</span>, <span class="pl-smi">dat_tbl_miss</span><span class="pl-k">$</span><span class="pl-smi">avg_steps</span>)

<span class="pl-c">#summaryize new dataset by day</span>
<span class="pl-v">dat_tbl_summary_miss</span> <span class="pl-k">=</span> <span class="pl-smi">dat_tbl_miss</span>[, <span class="pl-k">list</span>(<span class="pl-v">new_steps</span> <span class="pl-k">=</span> sum(<span class="pl-smi">new_steps</span>, <span class="pl-v">na.rm</span> <span class="pl-k">=</span> <span class="pl-c1">T</span>)), 
                          <span class="pl-v">by</span> <span class="pl-k">=</span> <span class="pl-smi">date</span>]
<span class="pl-c">#preview new dataset</span>
head(<span class="pl-smi">dat_tbl_summary_miss</span>)</pre></div>

<ol>
<li> Make a histogram of the total number of steps taken each day and Calculate and report the mean and median total number of steps taken per day. Do these values differ from the estimates from the first part of the assignment? What is the impact of imputing missing data on the estimates of the total daily number of steps?</li>
</ol>

<p><strong>Note: Mean and Median Are Reported In Legend Of Histogram</strong></p>

<div class="highlight highlight-source-r"><pre>gen_hist(<span class="pl-smi">dat_tbl_summary</span><span class="pl-k">$</span><span class="pl-smi">total_steps</span>, <span class="pl-s"><span class="pl-pds">'</span>Missing Values Removed<span class="pl-pds">'</span></span>)
gen_hist(<span class="pl-smi">dat_tbl_summary_miss</span><span class="pl-k">$</span><span class="pl-smi">new_steps</span>, <span class="pl-s"><span class="pl-pds">'</span>Missing Values Replaced With <span class="pl-cce">\n</span> Mean For Interval<span class="pl-pds">'</span></span>)
</pre></div>

<p><strong>Answer To Question:</strong>
The mean and the median are now almost the same after replacing missing values with the mean value for the relevant interval. It makes sense that the median value would now move closer to the mean. So the Median value increased after this method of missing value replacement.</p>

<h3><a id="user-content-are-there-differences-in-activity-patterns-between-weekdays-and-weekends" class="anchor" href="#are-there-differences-in-activity-patterns-between-weekdays-and-weekends" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Are there differences in activity patterns between weekdays and weekends?</h3>

<hr>

<ol>
<li> Create a new factor variable in the dataset with two levels – “weekday” and “weekend” indicating whether a given date is a weekday or weekend day.</li>
</ol>

<div class="highlight highlight-source-r"><pre><span class="pl-c">#Make Function To Return Either "Weekday" or "Weekend"</span>
<span class="pl-v">weekpart</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">x</span>){
        <span class="pl-k">if</span>(<span class="pl-smi">x</span> <span class="pl-k">%in%</span> c(<span class="pl-s"><span class="pl-pds">'</span>Saturday<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Sunday<span class="pl-pds">'</span></span>)){
                <span class="pl-k">return</span>(<span class="pl-s"><span class="pl-pds">'</span>Weekend<span class="pl-pds">'</span></span>)
        }

        <span class="pl-k">return</span>(<span class="pl-s"><span class="pl-pds">'</span>Weekday<span class="pl-pds">'</span></span>)
}

<span class="pl-c">#Add Name of Week</span>
<span class="pl-smi">dat_tbl_miss</span><span class="pl-k">$</span><span class="pl-v">dayname</span> <span class="pl-k">=</span> weekdays(as.Date(<span class="pl-smi">dat_tbl_miss</span><span class="pl-k">$</span><span class="pl-smi">date</span>))

<span class="pl-c">#Add Factor Variable To Differentiate Weekday and Weekend</span>
<span class="pl-smi">dat_tbl_miss</span><span class="pl-k">$</span><span class="pl-v">daytype</span> <span class="pl-k">=</span> as.factor(apply(as.matrix(<span class="pl-smi">dat_tbl_miss</span><span class="pl-k">$</span><span class="pl-smi">dayname</span>), <span class="pl-c1">1</span>, <span class="pl-smi">weekpart</span>))

<span class="pl-c">#Summarize Dataset: Mean grouped by interval and daytype</span>
<span class="pl-v">dat_tbl_summary_miss</span> <span class="pl-k">=</span> <span class="pl-smi">dat_tbl_miss</span>[, <span class="pl-k">list</span>(<span class="pl-v">avg_steps</span> <span class="pl-k">=</span> mean(<span class="pl-smi">new_steps</span>, <span class="pl-v">na.rm</span> <span class="pl-k">=</span> <span class="pl-c1">T</span>)), 
                          <span class="pl-v">by</span> <span class="pl-k">=</span> <span class="pl-k">list</span>(<span class="pl-smi">interval</span>, <span class="pl-smi">daytype</span>)]

<span class="pl-c">#inspect dataset</span>
str(<span class="pl-smi">dat_tbl_summary_miss</span>)</pre></div>

<p>Below is the panel plot:</p>

<div class="highlight highlight-source-r"><pre>library(<span class="pl-smi">lattice</span>)
xyplot(<span class="pl-smi">avg_steps</span><span class="pl-k">~</span><span class="pl-smi">interval</span> <span class="pl-k">|</span> <span class="pl-smi">daytype</span>, <span class="pl-v">data</span> <span class="pl-k">=</span> <span class="pl-smi">dat_tbl_summary_miss</span>,
      <span class="pl-v">type</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>l<span class="pl-pds">'</span></span>,
      <span class="pl-v">xlab</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Interval<span class="pl-pds">'</span></span>,
      <span class="pl-v">ylab</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Number of Steps<span class="pl-pds">'</span></span>,
      <span class="pl-v">layout</span> <span class="pl-k">=</span> c(<span class="pl-c1">1</span>,<span class="pl-c1">2</span>))</pre></div>
</article>
  </div>

</div>

<a href="#jump-to-line" rel="facebox[.linejump]" data-hotkey="l" style="display:none">Jump to Line</a>
<div id="jump-to-line" style="display:none">
  <!-- </textarea> --><!-- '"` --><form accept-charset="UTF-8" action="" class="js-jump-to-line-form" method="get"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /></div>
    <input class="linejump-input js-jump-to-line-field" type="text" placeholder="Jump to line&hellip;" aria-label="Jump to line" autofocus>
    <button type="submit" class="btn">Go</button>
</form></div>

  </div>
  <div class="modal-backdrop"></div>
</div>

    </div>
  </div>

    </div>

        <div class="container">
  <div class="site-footer" role="contentinfo">
    <ul class="site-footer-links right">
        <li><a href="https://status.github.com/" data-ga-click="Footer, go to status, text:status">Status</a></li>
      <li><a href="https://developer.github.com" data-ga-click="Footer, go to api, text:api">API</a></li>
      <li><a href="https://training.github.com" data-ga-click="Footer, go to training, text:training">Training</a></li>
      <li><a href="https://shop.github.com" data-ga-click="Footer, go to shop, text:shop">Shop</a></li>
        <li><a href="https://github.com/blog" data-ga-click="Footer, go to blog, text:blog">Blog</a></li>
        <li><a href="https://github.com/about" data-ga-click="Footer, go to about, text:about">About</a></li>
        <li><a href="https://github.com/pricing" data-ga-click="Footer, go to pricing, text:pricing">Pricing</a></li>

    </ul>

    <a href="https://github.com" aria-label="Homepage">
      <span aria-hidden="true" class="mega-octicon octicon-mark-github" title="GitHub "></span>
</a>
    <ul class="site-footer-links">
      <li>&copy; 2016 <span title="0.07129s from github-fe121-cp1-prd.iad.github.net">GitHub</span>, Inc.</li>
        <li><a href="https://github.com/site/terms" data-ga-click="Footer, go to terms, text:terms">Terms</a></li>
        <li><a href="https://github.com/site/privacy" data-ga-click="Footer, go to privacy, text:privacy">Privacy</a></li>
        <li><a href="https://github.com/security" data-ga-click="Footer, go to security, text:security">Security</a></li>
        <li><a href="https://github.com/contact" data-ga-click="Footer, go to contact, text:contact">Contact</a></li>
        <li><a href="https://help.github.com" data-ga-click="Footer, go to help, text:help">Help</a></li>
    </ul>
  </div>
</div>



    
    
    

    <div id="ajax-error-message" class="flash flash-error">
      <span aria-hidden="true" class="octicon octicon-alert"></span>
      <button type="button" class="flash-close js-flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
        <span aria-hidden="true" class="octicon octicon-x"></span>
      </button>
      Something went wrong with that request. Please try again.
    </div>


      
      <script crossorigin="anonymous" integrity="sha256-nuVc6vh/w03IYzQkn+9svs6I6BVHjg++gWQtV+0P/4k=" src="https://assets-cdn.github.com/assets/frameworks-9ee55ceaf87fc34dc86334249fef6cbece88e815478e0fbe81642d57ed0fff89.js"></script>
      <script async="async" crossorigin="anonymous" integrity="sha256-G+Ga1mKcjStSuxsBHGt+z3Q9tWkFTBwPNsjZhYzj9kA=" src="https://assets-cdn.github.com/assets/github-1be19ad6629c8d2b52bb1b011c6b7ecf743db569054c1c0f36c8d9858ce3f640.js"></script>
      
      
      
    <div class="js-stale-session-flash stale-session-flash flash flash-warn flash-banner hidden">
      <span aria-hidden="true" class="octicon octicon-alert"></span>
      <span class="signed-in-tab-flash">You signed in with another tab or window. <a href="">Reload</a> to refresh your session.</span>
      <span class="signed-out-tab-flash">You signed out in another tab or window. <a href="">Reload</a> to refresh your session.</span>
    </div>
    <div class="facebox" id="facebox" style="display:none;">
  <div class="facebox-popup">
    <div class="facebox-content" role="dialog" aria-labelledby="facebox-header" aria-describedby="facebox-description">
    </div>
    <button type="button" class="facebox-close js-facebox-close" aria-label="Close modal">
      <span aria-hidden="true" class="octicon octicon-x"></span>
    </button>
  </div>
</div>

  </body>
</html>

